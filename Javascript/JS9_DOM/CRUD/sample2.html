<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      #updatebtn {
        display: none;
      }
      /* #addbtn {
        display: block;
      } */
    </style>
  </head>
  <body>
    <form>
      <h1>Registration Form</h1>
      <label for="name">Name:</label>
      <input type="text" name="" id="name" /><br />
      <label for="age">Age:</label>
      <input type="text" name="" id="age" /><br />
      <label for="phone">Phone Number:</label>
      <input type="number" name="" id="phone" /><br />
      <label for="city">City:</label>
      <input type="text" name="" id="city" /><br />
      <label for="gender">Gender : </label> <br />
      <input type="radio" name="gender" value="Male" /> Male <br />
      <input type="radio" name="gender" value="Female" /> Female <br />
      <input type="radio" name="gender" value="Other" /> Other <br />
      <label for="subject">Subjects :</label> <br />
      <input type="checkbox" name="subject" value="HTML" /> HTML <br />
      <input type="checkbox" name="subject" value="CSS" /> CSS <br />
      <input type="checkbox" name="subject" value="JS" /> JS <br />
      <input type="checkbox" name="subject" value="ReactJS" /> ReactJS <br />
      <label for="blood">Blood Group:</label>
      <select name="" id="blood">
        <option value="">Select</option>
        <option value="B+">B+</option>
        <option value="AB+">AB+</option>
        <option value="AB-">AB-</option>
        <option value="A+">A+</option>
      </select>
      <br /><br />

      <button type="button" onclick="addUser()" id="addbtn">Adduser</button>
      <button type="button" onclick="updateuser()" id="updatebtn">
        Update User
      </button>
    </form>
    <br />
    <hr />
    <table border="1">
      <thead>
        <tr>
          <th>Name</th>
          <th>Age</th>
          <th>Phone Number</th>
          <th>City</th>
          <th>Gender</th>
          <th>Subjects</th>
          <th>Blood</th>
          <th>Edit</th>
          <th>Delete</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <script>
      var users = [];
      var allRadioBtns = document.getElementsByName("gender");
      var allcheckboxes = document.getElementsByName("subject");
      function addUser() {
        var user = {
          name: "",
          age: "",
          phone: "",
          city: "",
          gender: "",
          subject: [],
          blood: "",
        };
        for (a in user) {
          if (a != "gender" && a != "subject") {
            user[a] = document.getElementById(a).value;
            console.log(user);
          } else if (a == "gender") {
            allRadioBtns.forEach((radio) => {
              if (radio.checked) {
                user.gender = radio.value;
              }
            });
          } else if (a == "subject") {
            allcheckboxes.forEach((cb) => {
              if (cb.checked) {
                user.subject.push(cb.value);
              }
            });
          }
        }
        users.push(user);
        displayersUsers();
        clearForm();
      }
      function displayersUsers() {
        document.querySelector("tbody").innerHTML = "";
        users.forEach((usr, i) => {
          var myTr = document.createElement("tr");
          for (a in usr) {
            var mytd = document.createElement("td");
            mytd.innerHTML = usr[a];
            myTr.appendChild(mytd);
          }
          var EditTd = document.createElement("td");
          var EditButton = document.createElement("button");
          EditButton.innerHTML = "Edit";
          EditButton.setAttribute("onclick", "edituser(" + i + ")");
          EditTd.appendChild(EditButton);
          myTr.appendChild(EditTd);

          var DeleteTd = document.createElement("td");
          var DeleteButton = document.createElement("button");
          DeleteButton.innerHTML = "Delete";
          DeleteButton.setAttribute("onclick", "deleteuser(" + i + ")");
          DeleteTd.appendChild(DeleteButton);
          myTr.appendChild(DeleteTd);

          document.querySelector("tbody").appendChild(myTr);
        });
      }
      function clearForm() {
        var user = {
          name: "",
          age: "",
          phone: "",
          city: "",
          gender: "",
          subject: [],
          blood: "",
        };
        for (a in user) {
          if (a !== "gender" && a !== "subject") {
            document.getElementById(a).value = "";
            allRadioBtns.forEach((radio) => {
              radio.checked = false;
            });
            allcheckboxes.forEach((cb) => {
              cb.checked = false;
            });
          }
        }
      }
      function deleteuser(i) {
        users = users.filter((usr, index) => {
          return i != index;
        });
        displayersUsers();
      }
      function edituser(i) {
        gIndex = i;
        for (a in users[i]) {
          if (a != "gender" && a != "subject") {
            document.getElementById(a).value = users[i][a];
            allRadioBtns.forEach((radio) => {
              if (radio.value == users[i].gender) {
                radio.checked = true;
              }
            });
          } else if (a == "subject") {
            allcheckboxes.forEach((cb) => {
              console.log(users[i][a]);
              users[i][a].forEach((val)=>{
                if(val == cb.value){
                  cb.checked = true
                }
              })
            });
          }
        }
        document.getElementById("updatebtn").style.display = "block";
        document.getElementById("addbtn").style.display = "none";
      }
      function updateuser() {
        document.getElementById("updatebtn").style.display = "none";
        document.getElementById("addbtn").style.display = "block";
        var user = {
          name: "",
          age: "",
          phone: "",
          city: "",
          gender: "",
          subject: [],
          blood: "",
        };
        for (a in user) {
          if (a != "gender" && a != "subject") {
            user[a] = document.getElementById(a).value;
          } else if (a == "gender") {
            allRadioBtns.forEach((radio) => {
              if (radio.checked) {
                user.gender = radio.value;
              }
            });
          } else if (a == "subject") {
            allcheckboxes.forEach((cb) => {
              if (cb.checked) {
                user.subject.push(cb.value);
              }
            });
          }
        }
        users[gIndex] = user;
        displayersUsers();
        clearForm();
      }
    </script>
  </body>
</html>
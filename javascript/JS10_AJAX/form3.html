<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <label for="fname">First Name: </label>
    <input type="text" id="fname"><br><br>
    <label for="lname">Last Name: </label>
    <input type="text" id="lname"><br><br>
    <label for="email1">Your E-mail</label>
    <input type="text" id="email1"><br><br>
    <label for="email2">Re-Enter E-mail</label>
    <input type="text" id="email2"><br><br>
    <label for="pass">New Password</label>
    <input type="text" id="pass"><br><br>
    <label for="age">I am :</label>
    <input type="number" name="" id="age"><br><br>
    <label for="date">Birthday:</label>
    <input type="date" name="" id="date"><br><br>
    <input type="button" onclick="adduser()" value="Sign Up">
    <table border="1">
        <thead>
            <th>First Name</th>
            <th>Last Name</th>
            <th>Your E-mail</th>
            <th>Re-Enter E-mail</th>
            <th>New Password</th>
            <th>Age</th>
            <th>Birthday</th>
            <th>Id</th>
            <th>Edit</th>
            <th>Delete</th>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        function adduser() {
            var person = {
                fname: "",
                lname: "",
                email1:"",
                email2: "",
                pass: "",
                age: "",
                date: "",
            }
            for (a in person) {
                    person[a] = document.getElementById(a).value
                }
            var postData = new XMLHttpRequest();
            postData.onreadystatechange = function () {
                if (postData.readyState == 4 && postData.status == 202){
                    console.log("Users added succesfully")
                }
            }
                postData.open("POST", " http://localhost:3000/sita");
                postData.setRequestHeader("Content-Type", "application/json");
                postData.send(JSON.stringify(person))
        }
        function getusers() {
            var getinfo = new XMLHttpRequest();
            getinfo.onreadystatechange = function () {
                if (getinfo.readyState == 4 && getinfo.status == 200) {
                    console.log(JSON.parse(getinfo.response))
                    displayUsers(JSON.parse(getinfo.response))
                }
            }
            getinfo.open("GET", " http://localhost:3000/sita")
            getinfo.send()
        }
        getusers()
        function displayUsers(users) {
            users.forEach((usr, i) => {
                var myTr = document.createElement("tr")
                for (a in usr) {
                    var myTd = document.createElement("td")
                    myTd.innerHTML = usr[a]
                    myTr.appendChild(myTd)
                }
                var ediTd = document.createElement("td")
                var delTd = document.createElement("td")

                var editBtn = document.createElement("button")
                editBtn.innerHTML = "Edit"
                editBtn.setAttribute("onclick", "editUser(" + i + ")")
                var deleteBtn = document.createElement("button")
                deleteBtn.innerHTML = "Delete"
                deleteBtn.setAttribute("onclick", "deleteUser(" + i + ")")

                ediTd.appendChild(editBtn)
                delTd.appendChild(deleteBtn)

                myTr.appendChild(ediTd)
                myTr.appendChild(delTd)
                document.querySelector("tbody").appendChild(myTr)
            })
        }
    </script>
</body>

</html>

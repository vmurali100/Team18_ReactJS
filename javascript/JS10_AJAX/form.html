<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        * {
            margin: 0px;
            padding: 0px;
        }

        .container {
            border: 1px solid red;
            background-color: greenyellow;
            width: 403px;
            text-align: center;
            margin-left: 404px;
            margin-top: 24px;
            height: 665px;
        }

        h1 {
            color: red;
            text-transform: capitalize;
            font-family: 'Times New Roman', Times, serif;
            font-size: 20px;
        }

        button {
            width: 94px;
            color: white;
            background-color: orange;
            height: 30px;
            border-radius: 10px;
            border-color: white;
        }
    </style>
</head>

<body>
    <form action="">
        <div class="container">
            <h1>Personal details</h1>
            <br>
            <label for="name">Name:</label>
            <input type="text" id="name"><br><br>
            <label for="pass">Password:</label>
            <input type="text" id="pass"><br><br>
            <label for="email">E-mail id:</label>
            <input type="text" id="email"><br><br>
            <label for="gender">Gender:</label>
            <input type="radio" name="gender" value="Male">Male
            <input type="radio" name="gender" value="Female">Female<br><br>
            <label for="contact">Contact#:</label>
            <input type="text" id="contact"><br><br>
            <h1>educational qualifications</h1><br><br>
            <label for="select">Degree:</label>
                <select name="" id="select">
                <option value="">--SelectGroup--</option>
                <option value="B.Com">B.Com</option>
                <option value="B.Sc">B.Sc</option>
                <option value="BBA">BBA</option>
                <option value="BCA">BCA</option>
            </select>
            <br><br>
            <label for="group">Engineering:</label>
            <select name=""  id="group">
                <option value="">--SelectGroup--</option>
                <option value="Cse">Cse</option>
                <option value="Ece">Ece</option>
                <option value="Eee">Eee</option>
                <option value="Civil">Civil</option>
                <option value="Mech">Mech</option> 
            </select><br><br>
            <label for="hobb">Hobbies: </label>
            <input type="Checkbox" name="hobb" value="Playing chess">Playing chess
            <input type="Checkbox" name="hobb" value="Reading Books">Reading Books
            <br><br><br>
            <h1>Address</h1><br>
            <textarea name="" id="address" cols="38" rows="6"></textarea><br><br>
            <!-- <label for="">Attach Resume:</label>
            <input type="file" placeholder="Choose File" id="file">
            <br><br> -->
            <button type="button" onclick="adduser()">SUBMIT</button>
        </div>
    </form>
    <table border="1">
        <thead>
            <th>Name</th>
            <th>Password</th>
            <th>Email</th>
            <th>Gender</th>
            <th>Contact</th>
            <th>Select</th>
            <th>Group</th>
            <th>Hobbies</th>
            <th>Address</th>
        </thead>
        <tbody></tbody>
    </table>
    <script>
        var rbtns = document.getElementsByName("gender")
        var cbox = document.getElementsByName("hobb")
        function adduser() {
            var person = {
                name: "",
                pass: "",
                email: "",
                gender: "",
                contact: "",
                select : "",
                group: "",
                hobb: [],
                address: "",
                
            }
            for (a in person) {
                if (a != "gender" && a != "hobb") {
                    person[a] = document.getElementById(a).value
                }
                else if (a == "gender") {
                    rbtns.forEach((rb)=>{
                        if (rb.checked) {
                            person.gender = rb.value
                        }
                    });
                } else if (a == "hobb") {
                    cbox.forEach((cb)=>{
                        if (cb.checked) {
                            person.hobb.push(cb.value)
                        }
                    })
                }
            }

            var postData=new XMLHttpRequest();
            postData.onreadystatechange=function(){
                if(postData.readyState == 4 && postData.status == 202){
                    console.log("User Added Success")
                }
            }
            postData.open("POST","http://localhost:3000/users")
            postData.setRequestHeader("Content-Type","application/json")
            postData.send(JSON.stringify(person))
        }

        function getusers(){
            var getinfo= new XMLHttpRequest();
            getinfo.onreadystatechange=function(){
                if(getinfo.readyState == 4 && getinfo.status == 200){
                    console.log(JSON.parse(getinfo.response))
                    displayUsers(JSON.parse(getinfo.response))
                }
            }
            getinfo.open("GET","http://localhost:3000/users")
            getinfo.send()
        }
        getusers()
        function displayUsers(users){
            users.forEach((usr,i)=>{
                var myTr = document.createElement("tr")
                for(a in usr){
                    var myTd = document.createElement("td")
                    myTd.innerHTML = usr[a]
                    myTr.appendChild(myTd)
                }
                var ediTd = document.createElement("td")
                var delTd = document.createElement("td")

                var editBtn = document.createElement("button")
                editBtn.innerHTML = "Edit"
                editBtn.setAttribute("onclick","editUser("+i+")")
                var deleteBtn = document.createElement("button")
                deleteBtn.innerHTML = "Delete"
                 deleteBtn.setAttribute("onclick","deleteUser("+i+")")

                ediTd.appendChild(editBtn)
                delTd.appendChild(deleteBtn)

                myTr.appendChild(ediTd)
                myTr.appendChild(delTd)
                document.querySelector("tbody").appendChild(myTr)
            })
        }
        var index;
        function editUser(i){
            index=i;
            for(a in person[i]){
                document.getElementById(a).value=person[i][a];
            }
            console.log(person[a])
        }
        function deleteUser(i){
            var person = {
                name: "",
                pass: "",
                email: "",
                gender: "",
                contact: "",
                select : "",
                group: "",
                hobb: [],
                address: "",
                
            }
            var updateUser=new XMLHttpRequest();
            updateUser.onreadystatechange=function(){
                if(updateUser.readyState == 4 &&updateUser.status == 200){
                    console.log("updateUser")
                }
            }
            updateUser.open("PUT","http://localhost:3000/users"+person[index].i)
            updateUser.setRequestHeader("Content-Type","application/json")
            updateUser.send(JSON.stringify(person))
        }
    </script>
</body>

</html>